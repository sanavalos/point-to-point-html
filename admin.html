<!doctype html>
<html lang="en">
  <head>
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="stylesheet" href="css/style.css" />
      <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
        crossorigin="anonymous"
      />
      <link
        rel="stylesheet"
        href="https://use.fontawesome.com/releases/v5.12.1/css/all.css"
        crossorigin="anonymous"
      />
      <link rel="preconnect" href="https://fonts.googleapis.com" />
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
      <link
        href="https://fonts.googleapis.com/css2?family=Sometype+Mono:wght@700&family=Urbanist&display=swap"
        rel="stylesheet"
      />
      <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""
      />
      <title>Point to Point</title>
      <link rel="icon" href="./images/favicon.ico" />
    </head>
  </head>

  <body id="admin">
    <div class="contenido">
      <h1>Add Product to List</h1>

      <!--enctype="multipart/form-data" es necesario para enviar archivos al back.-->
      <form id="formulario" enctype="multipart/form-data">
        <label for="id">ID:</label>
        <input type="text" id="id" name="id" required /><br />

        <label for="id">Name:</label>
        <input type="text" id="name" name="name" required /><br />

        <label for="description">Description:</label>
        <input type="text" id="description" name="description" required /><br />

        <label for="price">Price:</label>
        <input type="text" id="price" name="price" required /><br />

        <label for="sale_price">Sale Price:</label>
        <input type="text" id="sale_price" name="sale_price" /><br />

        <button type="submit">Add Product</button>
      </form>

      <script>
        const URL = 'http://127.0.0.1:5000/'

        //Al subir al servidor, deber√° utilizarse la siguiente ruta. USUARIO debe ser reemplazado por el nombre de usuario de Pythonanywhere
        //const URL = "https://USUARIO.pythonanywhere.com/"
        document
          .getElementById('formulario')
          .addEventListener('submit', function (event) {
            event.preventDefault()

            var formData = new FormData()
            formData.append('id', document.getElementById('id').value)
            formData.append('name', document.getElementById('name').value)
            formData.append(
              'description',
              document.getElementById('description').value,
            )
            formData.append('price', document.getElementById('price').value)
            formData.append(
              'sale_price',
              document.getElementById('sale_price').value,
            )

            fetch(URL + 'products', {
              method: 'POST',
              body: formData,
            })
              .then(function (response) {
                if (response.ok) {
                  return response.json()
                } else {
                  throw new Error('Error al agregar el equipo.')
                }
              })

              .then(function (data) {
                alert('Equipo agregado correctamente.')
              })

              .catch(function (error) {
                alert('Error al agregar el equipo.')
              })

              .finally(function () {
                document.getElementById('id').value = ''
                document.getElementById('name').value = ''
                document.getElementById('description').value = ''
                document.getElementById('price').value = ''
                document.getElementById('sale_price').value = ''
              })
          })
      </script>
    </div>
  </body>
</html>
